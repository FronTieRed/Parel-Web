
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A revolutionary travel agency where people can build their own holiday with puzzle pieces and we let AI create the perfect holiday for them - Parel Agency Delivery</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; line-height: 1.6; color: #333; max-width: 900px; margin: 40px auto; padding: 0 20px; background-color: #f9f9f9; }
        h1, h2 { color: #1a1a1a; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        #details, #assets { min-height: 50px; }
        .asset { border: 1px solid #ddd; border-radius: 8px; padding: 20px; margin-bottom: 20px; background-color: #fff; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .asset-title { font-size: 1.2em; font-weight: bold; margin-bottom: 10px; color: #5865F2; }
        .asset-content { white-space: pre-wrap; color: #555; background-color: #f6f8fa; padding: 15px; border-radius: 5px; font-family: 'Courier New', Courier, monospace; }
        .asset-image { max-width: 100%; border-radius: 8px; margin-top: 10px; }
        .placeholder { font-style: italic; color: #888; }
        .footer { text-align: center; margin-top: 40px; font-size: 0.9em; color: #888; }
    </style>
</head>
<body>
    <div id="content" style="display: none;">
        <h1>Project Delivery: A revolutionary travel agency where people can build their own holiday with puzzle pieces and we let AI create the perfect holiday for them</h1>
        <h2>Project Details</h2>
        <div id="details"><i class="placeholder">Loading project details...</i></div>
        <hr>
        <h2>Generated Assets</h2>
        <div id="assets"><i class="placeholder">Loading assets...</i></div>
        <div class="footer"><p>Generated by Parel Agency on 29-6-2025</p></div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const content = document.getElementById('content');
            const password = "73500d22";
            const enteredPassword = prompt("Wachtwoord vereist:", "");

            if (enteredPassword !== password) {
                document.body.innerHTML = '<h1>Toegang Geweigerd</h1>';
                return;
            }
            
            content.style.display = 'block';

            // This script will now fetch data from our API
            const projectId = "PROJ-1751202600939";
            const apiUrl = "https://parel-api-service-658251237533.europe-west4.run.app";
            const apiKey = "zgxI0E/lxSi=rj-6grUbd6MK573=NsrDZX6bA?9hCh4qIEB2SCR?nSIqHCLDg6pf";

            fetch(`${apiUrl}/project/${projectId}`, {
                headers: { 'Authorization': `Bearer ${apiKey}` }
            })
            .then(response => response.ok ? response.json() : Promise.reject(response))
            .then(data => {
                if (data.error) throw new Error(data.error);
                
                const detailsDiv = document.getElementById('details');
                const assignedManager = data.assignedManager ? data.assignedManager.tag : 'Not Assigned';
                detailsDiv.innerHTML = `<p><strong>Status:</strong> ${data.status || 'N/A'}</p><p><strong>Submitted by:</strong> ${data.author || 'N/A'}</p><p><strong>Project Lead:</strong> ${assignedManager}</p>`;

                const assetsDiv = document.getElementById('assets');
                let assetsHtml = '';
                const assets = data.masterplan && data.masterplan.requiredAssets ? data.masterplan.requiredAssets : [];
                if(assets.length > 0){
                    assets.forEach(asset => {
                        const escapedDesc = asset.description || 'No description';
                        const generatedContent = asset.generatedContent || '';
                        assetsHtml += `<div class="asset"><div class="asset-title">${escapedDesc}</div>`;
                        if(asset.status === 'Completed' && generatedContent){
                            if(asset.type === 'copy') assetsHtml += `<pre class="asset-content">${generatedContent.replace(/</g, "&lt;")}</pre>`;
                            if(asset.type === 'image' && generatedContent.startsWith('http')) assetsHtml += `<img src="${generatedContent}" alt="${escapedDesc}" class="asset-image">`;
                        } else {
                            assetsHtml += `<div class="placeholder">Asset not yet generated.</div>`;
                        }
                        assetsHtml += `</div>`;
                    });
                } else {
                    assetsHtml = "<p>No assets defined in masterplan.</p>";
                }
                assetsDiv.innerHTML = assetsHtml;
            })
            .catch(async error => {
                console.error('Error fetching project data:', error);
                const errorDetails = await error.text();
                document.getElementById('details').innerHTML = `<p style="color: red;"><strong>Error:</strong> Could not load project data from the API. ${errorDetails}</p>`;
            });
        });
    </script>
</body></html>
